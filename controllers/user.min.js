const bcrypt=require("bcrypt"),User=require("../models/User"),jwt=require("jsonwebtoken");exports.signup=(req,res,next)=>{bcrypt.hash(req.body.password,10).then((hash=>{new User({email:req.body.email,password:hash}).save().then((()=>res.status(201).json({message:"new user created"}))).catch((error=>res.status(400).json({error:error})))})).catch((error=>res.status(500).json({error:error})))},exports.login=(req,res,next)=>{User.findOne({email:req.body.email}).then((user=>{null===user?res.status(401).json({message:"email or password incorect"}):bcrypt.compare(req.body.password,user.password).then((valid=>{valid?res.status(200).json({userId:user._id,token:jwt.sign({userId:user._id},"RANDOM_TOKEN_KEY",{expiresIn:"24h"})}):res.status(401).json({message:"email or password incorect"})})).catch((error=>res.status(500).json({error:error})))})).catch((error=>res.status(500).json({error:error})))};